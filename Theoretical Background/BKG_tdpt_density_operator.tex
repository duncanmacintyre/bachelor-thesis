\subsection{Time evolution of a pure state}

Suppose we have a Hamiltonian of the form \[\op{H} = \op{H}_0 + \lambda \op{V}(t)\]
where \(\op{H}_0\) is a well-understood Hamiltonian that does not depend on time and \(\lambda \op{V}(t)\) is ``small''. For example, \(\op{H}_0\) might be the free particle Hamiltonian \(\op{H}_0 = \frac{m}{2} \nabla^2\). Our equation of motion is the Schr\"odinger equation
\[i \hbar \frac{\partial}{\partial t} \ket{\Psi, t} = \left(\op{H}_0 + \lambda\op{V}(t)\right) \ket{\Psi, t}\]
where \(\ket{\Psi, t}\) is the usual Schr\"odinger-picture state at time \(t\).

Let \(\op{U}(t_0, t) = e^{-i\op{H}_0(t-t_0)/\hbar}\). Then \(\op{U}(t_0, t)\) is the operator that evolves a state from time \(t_0\) to time \(t\) according to \(\op{H}_0\). We define the interaction-picture state to be
\[\ket{\Psi_I, t} = \op{U}(t_0, t)^\dagger \ket{\Psi, t}\]
so \(\ket{\Psi, t} = \op{U}(t_0, t) \ket{\Psi_I, t}\).
Plugging this in to the Schr\"odinger equation,
\begin{align*}
i \hbar \frac{\partial}{\partial t} \op{U}(t_0, t)\ket{\Psi_I, t} &= \left(\op{H}_0 + \lambda \op{V}(t)\right) \op{U}(t_0, t)\ket{\Psi, t} \\
i \hbar \left[\frac{\partial}{\partial t} e^{-i\op{H}_0(t-t_0)/\hbar}\right] \ket{\Psi_I, t} + i \hbar e^{-i\op{H}_0(t-t_0)/\hbar} \frac{\partial}{\partial t} \ket{\Psi_I, t} &= \op{H}_0 e^{-i\op{H}_0(t-t_0)/\hbar}\ket{\Psi_I, t} + \lambda\op{V}(t) e^{-i\op{H}_0(t-t_0)/\hbar}\ket{\Psi_I, t} \\
\cancel{-i^2 \op{H}_0 e^{i\op{H}_0(t-t_0)/\hbar} \ket{\Psi_I, t}} + i \hbar e^{-i\op{H}_0(t-t_0)/\hbar} \frac{\partial}{\partial t} \ket{\Psi_I, t} &= \cancel{\op{H}_0 e^{-i\op{H}_0(t-t_0)/\hbar}\ket{\Psi_I, t}} + \lambda\op{V}(t) e^{-i\op{H}_0(t-t_0)/\hbar}\ket{\Psi_I, t} \\
 i \hbar \frac{\partial}{\partial t} \ket{\Psi_I, t} &= e^{i\op{H}_0(t-t_0)/\hbar}\lambda\op{V}(t) e^{-i\op{H}_0(t-t_0)/\hbar}\ket{\Psi_I, t} \\
 i \hbar \frac{\partial}{\partial t} \ket{\Psi_I, t} &= \lambda\op{H}_I(t)\ket{\Psi_I, t}
\end{align*}
where we define the interaction Hamiltonian to be
\[\op{H}_I(t) = \op{U}(t_0, t)^\dagger \op{V}(t)\op{U}(t_0, t) = e^{i\op{H}_0(t-t_0)/\hbar}\op{V}(t) e^{-i\op{H}_0(t-t_0)/\hbar}.\]

This sets up the interaction picture. We have rephrased our problem so that we can continue with quantum mechanics normally without having to worry about the time evolution due to \(\op{H}_0\).

We now integrate both sides of our expression.
\begin{align}
\int_{t_0}^t \frac{\partial}{\partial t^\prime} \ket{\Psi_I, t^\prime} &= -\frac{i}{\hbar} \lambda \int_{t_0}^t \op{H}_I(t^\prime)\ket{\Psi_I, t^\prime} \,dt^\prime \nonumber\\
\ket{\Psi_I, t} - \ket{\Psi_I, t_0} &= -\frac{i}{\hbar} \lambda \int_{t_0}^t \op{H}_I(t^\prime)\ket{\Psi_I, t^\prime} \,dt^\prime \nonumber\\
\ket{\Psi_I, t} &= \ket{\Psi_I, t_0} - \frac{i}{\hbar} \lambda \int_{t_0}^t \op{H}_I(t^\prime)\ket{\Psi_I, t^\prime} \,dt^\prime \label{eq.intse}
\end{align}
This is called the integral form of the Schr\"odinger equation.

We can now iteratively calculate perturbative approximations where we assume \(\op{H}_I(t)\) is small. The zero order approximation is simply
\[\ket{\Psi_I, t} = \ket{\Psi_I, t_0} + \Od{\lambda}.\]
Plugging this in for the state inside the integral in (\ref{eq.intse}), we get the first order approximation
\begin{equation}\label{eq.firsttdpe}
\ket{\Psi_I, t} = \ket{\Psi_I, t_0} - \frac{i}{\hbar} \lambda \int_{t_0}^t \op{H}_I(t^\prime)\ket{\Psi_I, t_0} \,dt^\prime + \Od{\lambda^2}.
\end{equation}
Plugging this in to (\ref{eq.intse}) again we get the second order approximation
\begin{align}\nonumber
\ket{\Psi_I, t} &= \ket{\Psi_I, t_0} - \frac{i}{\hbar} \lambda \int_{t_0}^t \op{H}_I(t^\prime)\left[\ket{\Psi_I, t_0} - \frac{i}{\hbar} \lambda \int_{t_0}^{t^\prime} \op{H}_I(t^{\prime\prime})\ket{\Psi_I, t_0} \,dt^{\prime\prime}\right] \,dt^\prime + \Od{\lambda^3} \\
&= \ket{\Psi_I, t_0} - \frac{i}{\hbar}\lambda \int_{t_0}^t \op{H}_I (t^\prime) \ket{\Psi_I, t_0}\,dt^\prime - \frac{\lambda^2}{\hbar^2} \int_{t_0}^t \int_{t_0}^{t^\prime} \op{H}_I(t^\prime) \op{H}_I(t^{\prime\prime})\ket{\Psi_I, t_0} \,dt^{\prime\prime}\,dt^\prime + \Od{\lambda^3}.
\label{eq.secondtdpe}\end{align}
In general, we can keep going to achieve higher order approximations. For us, however, the second order approximation (\ref{eq.secondtdpe}) is enough.


\subsection{Time evolution of the density operator}

We now consider mixed states. We will need to describe the system by the density operator \(\op{\rho}(t)\). Let's derive the time evolution of \(\op{\rho}(t)\) in second order perturbation theory based on (\ref{eq.secondtdpe}).

Suppose at time \(t_0\) we have a statistical ensemble of interaction-picture states \(\ket{{\psi_I}_n, t_0}\) each with probability \(P_n\). Then
\[\op{\rho}(t_0) = \sum_n P_n \ket{{\Psi_I}_n, t_0}\bra{{\Psi_I}_n, t_0}.\]
At time \(t\) states will have evolved according to (\ref{eq.secondtdpe}), so
\[\op{\rho}(t) = \sum_n P_n \ket{{\Psi_I}_n, t}\bra{{\Psi_I}_n, t}.\]
From (\ref{eq.secondtdpe}) we have
\begin{align*}
\ket{{\Psi_I}_n, t} &= \ket{\Psi_I, t_0} -\frac{i}{\hbar}\lambda\int_{t_0}^t \op{H}_I (t^\prime) \ket{\Psi_I, t_0}\,dt^\prime - \frac{\lambda^2}{\hbar^2} \int_{t_0}^t \int_{t_0}^{t^\prime} \op{H}_I(t^\prime) \op{H}_I(t^{\prime\prime})\ket{\Psi_I, t_0} \,dt^{\prime\prime}\,dt^\prime + \Od{\lambda^3} \\
\bra{{\Psi_I}_n, t} &= \bra{\Psi_I, t_0} -\frac{i}{\hbar}\lambda\int_{t_0}^t \bra{\Psi_I, t_0}{\op{H}_I} (t^\prime)\,dt^\prime - \frac{\lambda^2}{\hbar^2} \int_{t_0}^t \int_{t_0}^{t^\prime} \bra{\Psi_I, t_0} {\op{H}_I}(t^{\prime\prime}){\op{H}_I}(t^\prime)\,dt^{\prime\prime}\,dt^\prime + \Od{\lambda^3}
\end{align*}
so
\begin{align*}
\ket{{\Psi_I}_n, t} \bra{{\Psi_I}_n, t} \;\;=\;\;& \ket{{\Psi_I}_n, t_0} \bra{{\Psi_I}_n, t_0} 
\;\;-\;\;\frac{i}{\hbar}\lambda \int_{t_0}^t \left(\op{H}(t^\prime)\ket{{\Psi_I}_n, t_0}\bra{{\Psi_I}_n, t_0} - \ket{{\Psi_I}_n, t_0}\bra{{\Psi_I}_n, t_0} \op{H}_I (t^\prime)\right) \,dt^\prime \\
& -\;\; \frac{\lambda^2}{\hbar^2} \int_{t_0}^t \int_{t_0}^{t^\prime} \left( \op{H}_I (t^\prime) \op{H}_I(t^{\prime\prime}) \ket{{\Psi_I}_n, t_0}\bra{{\Psi_I}_n, t_0} +\;\; \ket{{\Psi_I}_n, t_0}\bra{{\Psi_I}_n, t_0} \op{H}_I(t^{\prime\prime}) \op{H}_I(t^\prime)\right)\,dt^{\prime\prime}\,dt^\prime \\
&+\;\; \frac{\lambda^2}{\hbar^2} \int_{t_0}^t \int_{t_0}^{t} \op{H}_I (t^\prime) \ket{{\Psi_I}_n, t_0}\bra{{\Psi_I}_n, t_0} \op{H}_I (t^{\prime\prime})\,dt^{\prime\prime}\,dt^\prime  \;\;+\;\; \Od{\lambda^3}.
\end{align*}
Then
\begin{align}
\label{eq.rhoevol}
\op{\rho}(t) \;\;=\;\;& \op{\rho}\left(t_0\right)
\;\;-\;\;\frac{i}{\hbar}\lambda \int_{t_0}^t \left[\op{H}(t^\prime),\; \op{\rho}(t_0) \right] \,dt^\prime \\
& -\;\; \frac{\lambda^2}{\hbar^2} \int_{t_0}^t \int_{t_0}^{t^\prime} \left( \op{H}_I (t^\prime) \op{H}_I(t^{\prime\prime}) \;\op{\rho}(t_0) + \op{\rho}(t_0)\; \op{H}_I (t^{\prime\prime}) \op{H}_I(t^{\prime}) \right)\,dt^{\prime\prime}\,dt^\prime \nonumber\\
&+\;\; \frac{\lambda^2}{\hbar^2} \int_{t_0}^t \int_{t_0}^{t} \op{H}_I (t^\prime) \op{\rho}(t_0) \op{H}_I (t^{\prime\prime})\,dt^{\prime\prime}\,dt^\prime \;\;+\;\; \Od{\lambda^3}\nonumber.
\end{align}


